from generator_placer_base import Symmetry, ShapeGenerator

import shapely
from shapely.geometry import LineString, Point, Polygon
from shapely.ops import split

from random import uniform as u, choice, seed, random
from math import sqrt, floor
import pandas as pd
import json


class SquareShapeGenerator(ShapeGenerator):
    def _get_shape(self):
        a = [[self._size, self._size], [self._size, 0], [0, 0], [0, self._size]]
        return a

    def __init__(self, radius: float, rotations: Symmetry, size: float = 1, container=None):
        self._size = size
        super().__init__(radius, rotations, container)


class LShapeGenerator(ShapeGenerator):
    def _get_shape(self):
        a = [[0, 0], [2 * self._size, 0], [2 * self._size, self._size], [self._size, self._size],
             [self._size, 2 * self._size], [0, 2 * self._size]]
        return a

    def __init__(self, radius: float, rotations: Symmetry, size: float = 1, container=None):
        self._size = size
        super().__init__(radius, rotations, container)


class CuttedShapeGenerator(ShapeGenerator):
    def _get_shape(self):
        if len(self._shape_buffer) > 0:
            return self._shape_buffer.pop()
        else:
            return [[1, 1], [1, 0], [0, 0], [0, 1]]

    def __init__(self, radius: float, rotations: Symmetry, fixed_seed: int = 1701, container=None):
        super().__init__(radius, rotations, container)
        if fixed_seed is not None:
            seed(fixed_seed)
        gc = [Point(0, 0).buffer(10)]

        def cut_all(gc, line):
            newgc = []
            for s in gc:
                newgc += split(s, line)
            return newgc

        for x in range(-10, 11, 2):
            line = LineString([(-10, x + u(-1, 1)), (10, x + u(-1, 1))])
            gc = cut_all(gc, line)
        for x in range(-10, 11, 2):
            line = LineString([(x + u(-1, 1), -10), (x + u(-1, 1), 10)])
            gc = cut_all(gc, line)
        # shift to zero and rotate
        shapes = []
        for g in gc:
            g = shapely.affinity.rotate(g, choice([0, 180]))
            g = shapely.affinity.translate(g, -g.exterior.coords[0][0], -g.exterior.coords[0][1])
            shapes.append(g)
        gc = [list(g.simplify(0.3, preserve_topology=False).exterior.coords) for g in shapes if g.area > 0.2]
        self._shape_buffer = gc


class RandomShapeGenerator(ShapeGenerator):
    def _get_shape(self):
        a = []
        a.append([random(), random()])
        a.append([-random(), random()])
        a.append([-random(), -random()])
        a.append([random(), -random()])
        return a

    def __init__(self, radius: float, rotations: Symmetry, fixed_seed: int = 1701, container=None):
        super().__init__(radius, rotations, container)
        if fixed_seed is not None:
            seed(fixed_seed)


class RandomHexagonShapeGenerator(ShapeGenerator):
    def _get_shape(self):
        random_1D_points = [Point((random() + 0.1, 0)) for _ in range(6)]
        random_rotate = [shapely.affinity.rotate(item, random() * 59, origin=(0, 0)) for item in random_1D_points]
        shape = [shapely.affinity.rotate(random_rotate[k], 60 * k, origin=(0, 0)) for k in range(6)]
        coords = [list(item.coords)[0] for item in shape]
        return coords

    def __init__(self, radius: float, rotations: Symmetry, fixed_seed: int = 1701, container=None):
        super().__init__(radius, rotations, container)
        if fixed_seed is not None:
            seed(fixed_seed)


class RealShapeGenerator(ShapeGenerator):
    def _get_shape(self):
        if len(self._shape_buffer) == 0:
            copied_buffer = self._FIXED_SHAPES.copy()
            polygonized_buffer = [Polygon(item) for item in copied_buffer]
            scaled_buffer = [
                shapely.affinity.scale(item, xfact=(random() / 2) + (5 / 6), yfact=(random() / 2) + (5 / 6)) for item in
                polygonized_buffer]
            rotated_buffer = [shapely.affinity.rotate(item, random() * 90) for item in scaled_buffer]
            coords_buffer = [list(item.exterior.coords) for item in rotated_buffer]
            self._shape_buffer = coords_buffer
        s = self._shape_buffer.pop()
        poly = Polygon(s)
        poly = shapely.affinity.scale(poly, xfact=self._scale_factor, yfact=self._scale_factor)
        poly = shapely.affinity.translate(poly, -poly.exterior.coords[0][0], -poly.exterior.coords[0][1])
        return list(poly.exterior.coords)

    def __init__(self, radius: float, rotations: Symmetry, scale: float = 1, fixed_seed: int = 1701, container=None):
        super().__init__(radius, rotations, container)
        self._scale_factor = scale
        self._shape_buffer = self._FIXED_SHAPES.copy()
        if fixed_seed is not None:
            seed(fixed_seed)


    _FIXED_SHAPES = [
        [(-670, -793.503), (-673.333, -740.836), (-630, -737.503), (-607.333, -757.503), (-576, -760.836),
         (-571.333, -771.503), (-561.333, -774.836), (-563.333, -783.503), (-582.667, -789.503), (-590, -794.17),
         (-656, -798.836)],
        [(-633.333, -854.836), (-608, -830.17), (-582.667, -853.503), (-593.333, -873.503), (-627.333, -866.17)],
        [(-386, -522.17), (-374.667, -498.17), (-368, -498.836), (-362, -486.17), (-332, -500.17), (-348, -530.17)],
        [(-124.667, -636.17), (-106, -651.503), (-88.667, -660.836), (-66, -671.503), (-52.667, -630.17),
         (-84, -618.836), (-90, -622.17), (-109.334, -616.836), (-120.667, -622.836)],
        [(-144.667, -729.503), (-116, -722.17), (-106.667, -727.503), (-92, -780.17), (-92.667, -788.17),
         (-116.667, -790.17), (-128, -771.503), (-136, -765.503)],
        [(51.999, -584.17), (98.666, -605.503), (114.666, -590.836), (133.999, -589.503), (141.999, -562.836),
         (133.333, -551.503), (126.666, -538.17), (80.666, -521.503)],
        [(-34, -478.17), (-22, -456.17), (-16, -430.17), (-26.667, -428.17), (-28, -420.836), (-130.667, -404.17),
         (-139.334, -458.17), (-119.334, -468.836)],
        [(-359.334, -421.503), (-324, -389.503), (-340.667, -361.503), (-359.334, -366.836), (-384.667, -386.17)],
        [(-386.667, -319.503), (-356.667, -308.17), (-379.334, -240.836), (-424.667, -253.503)],
        [(153.333, -476.837), (128.666, -422.171), (125.999, -398.171), (73.999, -397.504), (56.666, -414.171),
         (57.333, -460.171), (67.333, -474.837)],
        [(80.666, -366.171), (74.666, -355.504), (73.333, -344.837), (32.666, -306.837), (25.333, -320.171),
         (17.333, -339.504), (62.666, -382.171)],
        [(-1.334, -350.837), (-8.667, -332.171), (-17.334, -316.837), (-58, -329.504), (-52, -351.504),
         (-42.667, -378.837), (-34.667, -377.504), (-4.667, -352.171)],
        [(-14, -288.171), (55.999, -287.504), (69.333, -280.837), (85.333, -282.837), (85.333, -264.837),
         (75.333, -256.837), (59.333, -254.171), (54.666, -250.837), (-14, -250.171)],
        [(-207.334, -218.837), (-131.334, -176.171), (-159.334, -130.171), (-190.667, -120.837), (-242, -152.837),
         (-246, -168.171), (-225.334, -202.171), (-214, -200.837)],
        [(-268.667, -184.837), (-258, -129.504), (-302, -119.504), (-320, -126.837), (-335.334, -172.171),
         (-317.334, -194.837), (-307.334, -190.171), (-297.334, -192.837), (-280.667, -182.837)],
        [(-13.334, -153.504), (-24.667, -201.504), (17.333, -214.837), (25.333, -205.504), (38.666, -174.171),
         (-4, -162.171), (-2.667, -154.837)],
        [(125.332, -289.504), (135.332, -226.171), (142.665, -228.171), (149.332, -210.837), (166.665, -225.504),
         (183.332, -230.837), (175.332, -294.837)],
        [(-170.667, -81.504), (-150.667, -78.838), (-123.333, -89.504), (-114, -33.504), (-128.667, -28.171),
         (-126, -18.171), (-166.667, -12.838)],
        [(-581.333, -90.837), (-536.667, -37.504), (-542, -23.504), (-570, -4.171), (-598, -42.171),
         (-596.667, -50.837), (-606, -75.504)],
        [(-44.667, 101.162), (-44.667, 133.829), (36, 137.829), (64, 121.162), (69.333, 111.162), (56.666, 101.162)],
        [(-5.333, -75.504), (72, -58.837), (78.666, -38.171), (81.333, -22.837), (-8, -34.171), (-13.333, -44.171)],
        [(31.332, -898.837), (23.999, -890.837), (13.332, -884.837), (7.332, -880.837), (63.999, -842.837),
         (122.665, -808.171), (139.332, -826.837), (139.332, -838.837)],
        [(255.999, -842.171), (253.332, -828.837), (251.332, -818.837), (289.332, -758.837), (319.332, -724.171),
         (331.332, -744.837), (329.332, -761.504)],
        [(24.665, -736.171), (43.332, -746.837), (131.999, -667.504), (128.665, -654.171), (107.999, -652.837)],
        [(680.665, -434.838), (622.665, -370.838), (639.998, -351.504), (658.665, -349.504), (688.665, -407.504),
         (685.332, -424.171)],
        [(-887.336, -136.837), (-812.669, -132.171), (-812.669, -100.837), (-850.669, -103.504), (-886.669, -122.171)],
        [(326.663, -586.171), (352.663, -524.837), (378.663, -502.171), (409.33, -496.171), (391.33, -511.504),
         (376.663, -550.837), (383.997, -561.504), (367.997, -598.837)],
    ]


class CecoinGenerator(RealShapeGenerator):

    def __init__(self, radius: float, rotations: Symmetry, scale: float, fixed_seed: int = 1701, container=None):
        super().__init__(radius, rotations, scale=scale, fixed_seed=fixed_seed, container=container)

    # see cecoin-source.jpg for shape source
    _FIXED_SHAPES = [
        [(1018.679, 1388.908), (1018.679, 1407.915), (996.903, 1406.623), (985.832, 1392.045), (989.892, 1389.276)],
        [(1010.929, 1387.616), (993.397, 1387.247), (979.558, 1381.896), (991.552, 1365.472), (1011.298, 1366.025)],
        [(914.785, 1371.008), (911.648, 1380.973), (881.938, 1374.329), (887.843, 1365.103)],
        [(921.613, 1378.021), (937.853, 1384.294), (945.603, 1384.479), (948.371, 1383.372), (947.633, 1377.467),
         (945.603, 1377.098), (945.418, 1363.811), (945.787, 1349.417), (919.398, 1348.679), (912.018, 1350.894),
         (900.207, 1361.597), (919.398, 1363.626)],
        [(861.823, 1343.512), (860.716, 1359.382), (863.669, 1362.889), (887.474, 1361.228), (886.92, 1356.983),
         (879.724, 1355.322), (883.414, 1348.125), (879.539, 1344.065), (875.664, 1347.94)],
        [(953.354, 1364.918), (954.117, 1365.048), (967.563, 1367.317), (971.068, 1359.936), (976.051, 1361.412),
         (978.45, 1375.067), (977.527, 1385.955), (969.224, 1395.92), (958.705, 1394.997), (953.354, 1378.758)],
        [(1065.667, 1339.667), (1078.333, 1339.667), (1081, 1349.001), (1075.667, 1354.001), (1067, 1352.001)],
        [(1019, 1356.667), (992.333, 1355.334), (987, 1338.334), (988.333, 1328.001), (996.333, 1328.667),
         (998.333, 1318.001), (1012, 1318.334), (1016.333, 1332.667), (1020.333, 1332.667)],
        [(1086.333, 1309.667), (1085.333, 1264.334), (1072.667, 1257.667), (1064.667, 1260.334), (1061.333, 1265.667),
         (1042, 1267.334), (1040.333, 1278.334), (1037.333, 1278.334), (1035.667, 1302.001), (1041.667, 1307.667),
         (1042.667, 1311.334)],
        [(1105, 1268.667), (1103.667, 1294.334), (1109.667, 1299.667), (1129, 1299.667), (1134.333, 1288.334),
         (1132.333, 1274.334), (1124.333, 1264.667), (1115.667, 1264.001), (1113.333, 1268.001)],
        [(1190, 1234), (1190.333, 1253.667), (1157, 1252.333), (1157.333, 1247), (1148, 1242.333), (1146, 1231),
         (1153, 1224.333), (1164, 1229.333)],
        [(1131.333, 1235.667), (1130.667, 1255), (1113.333, 1257.333), (1105.333, 1249), (1106.333, 1236),
         (1110.333, 1229), (1125, 1229)],
        [(1099.333, 1232.667), (1102, 1250.667), (1084.667, 1255.667), (1075.667, 1254.667), (1057.667, 1254),
         (1059.333, 1241.667), (1066.667, 1234.667), (1075.667, 1229.667), (1094, 1228.667)],
        [(1028.667, 1273.667), (1030.333, 1313.667), (993, 1312.667), (984, 1306), (982.667, 1272.333),
         (988.667, 1267.333), (1021.333, 1266.333)],
        [(960, 1299.667), (962.667, 1316.667), (910, 1317.667), (906.333, 1312.667), (906, 1271.333), (922, 1275.667),
         (941.667, 1282), (949.667, 1298)],
        [(907.333, 1326.333), (923.333, 1326), (925.333, 1321), (957.667, 1318.333), (965, 1324.333), (976, 1322.667),
         (987, 1325), (980.333, 1333.333), (969.667, 1335), (907, 1337), (902.333, 1330.667)],
        [(844.667, 1265), (857.667, 1261.333), (859.333, 1256), (873.333, 1260.333), (873.667, 1268), (885.333, 1277),
         (888, 1306.333), (892.333, 1322), (886.667, 1325), (885, 1332.333), (846.667, 1333.333), (841.333, 1323.667),
         (843, 1311), (833.333, 1312.333), (831.667, 1304.333), (842.667, 1299)],
        [(788.667, 1217.667), (818.667, 1215), (819.333, 1263.667), (812.667, 1298.667), (794.333, 1300.667)],
        [(821.333, 1224.667), (820.667, 1242), (836.667, 1241), (840.667, 1236.667), (849, 1237.667),
         (852.333, 1241.667), (873.667, 1239.333), (878.333, 1243.333), (885, 1244), (892.333, 1238.333), (890, 1224),
         (881, 1215), (825, 1218.667)],
        [(900, 1215.667), (899, 1230), (921, 1246.333), (940.333, 1233.667), (953, 1231.667), (957.333, 1216.667)],
        [(906, 1250.667), (901, 1258.667), (905.333, 1260.667), (908, 1268.333), (949.333, 1264), (950, 1246),
         (931.667, 1247.333), (927.333, 1250.333), (923, 1249)],
        [(955.667, 1340.667), (970, 1340.667), (970.333, 1348.333), (966.667, 1358), (959.333, 1356.333),
         (949, 1350.333), (949, 1341)],
        [(1048, 1333), (1057, 1348), (1059.667, 1354), (1046.667, 1359), (1029.333, 1356.667), (1022.667, 1344.333),
         (1023, 1327.667)],
        [(961.667, 1228.667), (961, 1256), (963.667, 1262), (981, 1262.333), (989.333, 1254), (990, 1243.667),
         (989.667, 1231), (983.333, 1218.667), (964, 1219.667)],
        [(999, 1219.667), (1025, 1220), (1027.333, 1233.667), (1017.333, 1238.333), (1003.667, 1236.667),
         (996.667, 1231.333)],
        [(1000.333, 1240.333), (1024, 1242.667), (1031.667, 1254), (1025, 1265), (998.667, 1264.667), (994, 1257),
         (992.333, 1247.667)],
        [(1032.667, 1219), (1031.333, 1226.333), (1047, 1241), (1052.333, 1240.667), (1056.333, 1237.667),
         (1056, 1216.333)],
        [(1192.333, 1170.334), (1191, 1201.668), (1197.667, 1209.668), (1251, 1210.334), (1240.333, 1193.668),
         (1212.333, 1171.001)],
        [(1245, 1165.001), (1251, 1189.001), (1257, 1194.334), (1279.667, 1194.334), (1287, 1181.668), (1287, 1171.668),
         (1271.667, 1162.334)],
        [(1180.333, 1172.334), (1184.333, 1183.668), (1162.333, 1189.668), (1149.667, 1180.334), (1153.667, 1172.334),
         (1161.667, 1165.668)],
        [(1146.333, 1167.668), (1146.333, 1187.668), (1122.333, 1186.334), (1119.667, 1181.668), (1117, 1167.668),
         (1121, 1165.001)],
        [(1107, 1200.334), (1109, 1217.668), (1069.667, 1219.001), (1066.333, 1201.001), (1085.667, 1199.668),
         (1091.667, 1195.668)],
        [(1126.333, 1195.001), (1126.333, 1215.001), (1167.667, 1213.001), (1155.667, 1194.334)],
        [(1106.333, 1171.668), (1105, 1187.001), (1093.667, 1193.001), (1082.333, 1194.334), (1067, 1188.334),
         (1061, 1182.334), (1063.667, 1171.001)],
        [(994.333, 1180.334), (1038.333, 1178.334), (1039, 1198.334), (1033.667, 1206.334), (1028.333, 1206.334),
         (1024.333, 1204.334), (1018.333, 1208.334), (1002.333, 1207.668), (993.667, 1198.334)],
        [(989, 1173.001), (989, 1193.001), (986.333, 1198.334), (953.667, 1199.668), (944.333, 1187.668),
         (947.667, 1175.001)],
        [(997.667, 1131.001), (1002.333, 1171.668), (1005, 1175.668), (1035.667, 1175.001), (1029, 1167.668),
         (1040.333, 1131.001)],
        [(981, 1116.334), (978.333, 1164.334), (967.667, 1164.334), (950.333, 1137.001), (951, 1115.668)],
        [(888.333, 1127.668), (885.667, 1171.668), (848.333, 1170.334), (848.333, 1163.668), (869, 1125.668)],
        [(891.667, 1126.334), (887.667, 1194.334), (894.333, 1202.334), (925.667, 1204.334), (933, 1189.668),
         (933.667, 1175.001), (928.333, 1167.668), (925, 1157.001), (937.667, 1149.668), (944.333, 1138.334),
         (932.333, 1127.668)],
        [(843.667, 1179.668), (861, 1178.334), (871.667, 1193.001), (871.667, 1200.334), (851, 1200.334),
         (841.667, 1191.668)],
        [(823, 1154.334), (839.667, 1173.668), (838.333, 1205.001), (811.667, 1203.668), (810.333, 1156.334)],
        [(775.667, 1155.668), (791, 1155.668), (795.667, 1171.001), (807.667, 1173.668), (806.333, 1203.668),
         (769, 1203.001)],
        [(791.667, 1151.668), (735, 1149.668), (750.333, 1103.668), (757, 1099.001), (776.333, 1108.334),
         (776.333, 1123.668), (775, 1129.668), (791, 1137.001)],
        [(766.333, 1154.334), (770.333, 1167.668), (763.667, 1179.668), (733.667, 1179.668), (730.333, 1167.668),
         (736.333, 1153.001)],
        [(816.333, 1085.001), (802.333, 1101.668), (803.667, 1127.668), (797.667, 1139.001), (807.667, 1145.668),
         (841.667, 1147.001), (849, 1138.334), (845, 1101.001)],
        [(846.333, 1085.001), (847.667, 1113.001), (858.333, 1115.001), (861.667, 1118.334), (879, 1117.668),
         (882.333, 1104.334), (877, 1103.668), (877, 1089.668), (861.667, 1081.668)],
        [(1052.333, 1109.668), (1056.333, 1101.001), (1085, 1099.001), (1098.333, 1107.001), (1109, 1117.001),
         (1117, 1133.001), (1117, 1157.668), (1062.333, 1159.668), (1052.333, 1153.001)],
        [(1103.667, 1098.334), (1105.667, 1107.001), (1122.333, 1114.334), (1179.667, 1114.334), (1179.667, 1096.334)],
        [(1123.667, 1122.334), (1122.333, 1141.668), (1128.333, 1152.334), (1143.667, 1162.334), (1161, 1161.001),
         (1167.667, 1154.334), (1165, 1119.668)],
        [(1176.333, 1119.668), (1173.667, 1123.668), (1176.333, 1149.668), (1195, 1157.001), (1212.333, 1149.001),
         (1210.333, 1124.334), (1205.667, 1119.668)],
        [(1223.667, 1119.668), (1221, 1126.334), (1225.667, 1154.334), (1239.667, 1154.334), (1259, 1148.334),
         (1269.667, 1119.001), (1261, 1114.334)],
        [(1282.333, 1095.001), (1283, 1135.668), (1291, 1134.334), (1295.667, 1123.668), (1314.333, 1113.001),
         (1301.667, 1093.001)],
        [(1303.667, 1042.334), (1305, 1065.668), (1286.333, 1065.668), (1281, 1046.334)],
        [(1307, 1059.001), (1305, 1081.668), (1320.333, 1091.001), (1333, 1087.668), (1339, 1077.001),
         (1337.667, 1059.668)],
        [(1304.333, 957.001), (1311.667, 987.001), (1335.667, 985.667), (1347, 967.667), (1347, 958.334),
         (1331.667, 953.667), (1307, 957.667)],
        [(1310.333, 1012.334), (1337.667, 1012.334), (1338.333, 1029.001), (1327.667, 1039.667), (1310.333, 1045.001),
         (1307, 1039.667)],
        [(1245.667, 1039.667), (1245.667, 1060.334), (1261.667, 1071.001), (1272.333, 1071.001), (1273, 1045.667)],
        [(1239.667, 1073.001), (1272.313, 1071.078), (1275.667, 1083.001), (1260.333, 1097.667), (1239.667, 1092.334)],
        [(1199.667, 1078.334), (1201, 1102.334), (1227, 1102.334), (1223, 1079.667)],
        [(1157.667, 1043.001), (1159, 1081.667), (1197, 1081.667), (1197, 1076.334), (1185, 1069.001),
         (1177, 1045.001)],
        [(1053, 1014.334), (1055.667, 1092.334), (1130.333, 1090.334), (1142.333, 1056.334), (1142.333, 1035.001),
         (1129.667, 1023.667), (1108.333, 1023.667), (1101, 1013.001), (1084.333, 1001.667), (1067.667, 1001.667)],
        [(1050.333, 1039.667), (1052.333, 1093.001), (1016.333, 1093.001), (1011, 1086.334), (1014.333, 1075.001),
         (1013, 1058.334), (1035, 1038.334)],
        [(1026.333, 1025.667), (1026.333, 1040.334), (1005, 1041.001), (1004.333, 1026.334)],
        [(997, 1051.001), (998.333, 1098.334), (990.333, 1105.667), (946.333, 1104.334), (981, 1050.334)],
        [(993.667, 1108.334), (989.667, 1113.667), (995.667, 1122.334), (1029, 1120.334), (1030.333, 1109.667),
         (1025, 1105.667)],
        [(907, 1051.001), (906.333, 1092.334), (911.667, 1100.334), (946.333, 1101.001), (941, 1052.334)],
        [(879.667, 1056.334), (887.667, 1065.667), (890.333, 1075.667), (853, 1075.001), (847, 1071.001),
         (847, 1056.334)],
        [(933, 1004.334), (948.333, 1019.667), (949, 1030.334), (935, 1041.001), (911.667, 1042.334), (899, 1028.334),
         (898.333, 1007.001)],
        [(959.667, 1021.001), (975.667, 1012.334), (991, 1013.001), (989, 1031.001), (985.667, 1035.667),
         (965, 1035.667), (961.667, 1031.667)],
        [(992.333, 983.667), (995.667, 1013.667), (1037, 1018.334), (1047, 1003.001), (1043, 985.667),
         (1034.333, 978.334), (1013, 978.334)],
        [(1277, 955.667), (1277, 979.001), (1295, 979.001), (1296.333, 963.001)],
        [(1245.667, 965.001), (1269.667, 967.667), (1271, 986.334), (1256.333, 992.334), (1244.333, 984.334)],
        [(1239.667, 984.334), (1239.667, 1031.667), (1213.667, 1033.001), (1207.667, 1001.667), (1221, 982.334)],
        [(1211, 1040.334), (1231.667, 1039.667), (1239.667, 1047.667), (1239, 1065.001), (1210.333, 1066.334),
         (1207.667, 1061.667), (1205.667, 1045.667)],
        [(1309, 992.334), (1303, 1039.001), (1291, 1039.001), (1291, 1020.334), (1287.667, 1021.001), (1285, 993.667)],
        [(1279.667, 999.001), (1280.333, 1021.667), (1252.333, 1022.334), (1254.333, 997.001)],
        [(1202.333, 991.667), (1203, 1045.667), (1188.333, 1046.334), (1187, 991.667)],
        [(1202.333, 949.001), (1197.667, 973.667), (1205, 979.667), (1221, 979.667), (1219, 955.001)],
        [(944.333, 925.001), (945, 957.001), (985, 955.001), (985.667, 924.334)],
        [(945, 961.667), (979.667, 959.667), (981, 997.667), (946.333, 998.334)],
        [(937.667, 938.334), (936.333, 997.001), (907.667, 996.334), (907.667, 938.334)],
        [(765, 929.667), (760.333, 935.667), (760.333, 954.334), (782.333, 954.334), (787, 938.334), (785, 927.667),
         (779.667, 930.334)],
        [(791.667, 935.001), (796.333, 955.001), (804.333, 955.001), (817, 948.334), (817.667, 932.334)],
        [(792.333, 957.667), (795, 973.667), (776.333, 973.667), (775.667, 967.667), (778.333, 957.667)],
        [(762.333, 959.001), (764.333, 970.334), (757.667, 979.667), (748.333, 974.334), (747, 968.334),
         (749, 960.334)],
        [(759.667, 991.667), (759, 1005.667), (772.333, 1005.667), (773, 991.667)],
        [(767.667, 1012.334), (770.333, 1029.667), (790.333, 1029.667), (787, 1010.334)],
        [(773.667, 1036.334), (777.667, 1047.667), (770.333, 1050.334), (737.667, 1051.667), (738.333, 1034.334)],
        [(792.333, 1027.001), (797, 1045.667), (827, 1043.001), (827, 1033.667), (823, 1024.334)],
        [(799.667, 1052.334), (802.333, 1065.667), (811, 1074.334), (829, 1075.001), (826.333, 1050.334)],
        [(798.333, 1065.667), (799.667, 1089.667), (779.667, 1100.334), (768.333, 1091.001), (768.333, 1063.001)],
        [(765, 1058.334), (765, 1089.667), (759.667, 1094.334), (749.667, 1092.334), (725, 1077.001), (723, 1061.667)],
        [(933.667, 880.334), (967.667, 880.334), (967.667, 897.667), (961, 903.667), (939, 903.667),
         (933.667, 898.334)],
        [(938.333, 860.334), (933, 877.667), (909, 877.667), (901.667, 873.001), (901.667, 864.334), (921, 858.334)],
        [(945, 829.667), (935, 841.667), (867.667, 842.334), (862.333, 832.334), (867, 828.334)],
        [(891, 862.334), (889, 875.001), (874.333, 875.001), (873.667, 860.334)],
        [(866.25, 884.418), (870.333, 897.667), (895.667, 897.667), (894.333, 887.001)],
        [(999, 929.001), (999, 945.667), (1059.667, 943.667), (1070.333, 935.001), (1067, 929.667)],
        [(1004.333, 953.667), (996.333, 963.667), (1011.667, 972.334), (1053, 969.001), (1047.667, 954.334)],
        [(923, 901.001), (922.333, 927.667), (905.667, 927.667), (900.333, 921.001), (900.333, 907.001)],
        [(927.667, 888.334), (927.667, 897.667), (904.333, 899.667), (903, 889.001)],
        [(893, 905.001), (896.333, 909.001), (893, 919.667), (871.667, 921.667), (870.333, 909.667)],
        [(860.269, 917.107), (858.333, 935.667), (838.333, 937.001), (839, 917.001)],
        [(789.667, 983.001), (832.333, 983.001), (835.667, 992.334), (831.667, 1002.334), (789.667, 1002.334),
         (785.667, 995.001)],
        [(863, 892.334), (866.333, 903.001), (860.38, 916.85), (815, 911.667), (797, 908.334), (820.333, 901.001),
         (848.333, 899.667)],
        [(831.667, 861.001), (831, 874.334), (815.667, 873.001), (816.333, 860.334)],
        [(841, 869.667), (839.667, 882.334), (865.583, 884.168), (863.667, 877.001), (863.667, 871.667)],
        [(869, 939.667), (869, 958.334), (863.667, 968.334), (873, 973.667), (898.333, 975.001), (899.667, 949.667),
         (893, 946.334), (893, 934.334), (874.333, 934.334)],
        [(819, 957.001), (822.333, 975.001), (829, 979.667), (842.333, 977.667), (838.333, 955.667)],
        [(722.333, 1095.667), (721.667, 1111.667), (727, 1115.001), (731, 1111.001), (731, 1093.001)],
        [(846.333, 1003.667), (859.667, 989.001), (879.667, 990.334), (885, 995.001), (885, 1021.667), (883, 1027.001),
         (847.667, 1024.334)],
        [(844.333, 1034.334), (851.667, 1030.334), (874.333, 1029.001), (881, 1035.667), (893, 1043.001),
         (887, 1047.667), (879.667, 1047.667), (879.667, 1053.667), (845, 1053.001), (843.667, 1044.334)],
        [(896.333, 817.001), (894.333, 825.667), (917, 826.334), (919, 821.001), (913, 819.667), (913.667, 815.001)],
        [(934.333, 805.667), (934.333, 825.001), (948.333, 825.001), (955.667, 817.001), (950.333, 807.667)],
        [(968.333, 786.334), (969, 811.667), (978.333, 810.334), (985, 805.667), (981.667, 781.001)],
        [(1004.333, 780.334), (1005.667, 802.334), (1039.667, 803.667), (1042.333, 786.334)],
        [(997, 814.334), (1006.333, 823.001), (1005, 837.667), (995.667, 842.334), (958.333, 840.334),
         (954.333, 835.001), (973, 814.334)],
        [(989, 852.334), (989, 873.001), (993.667, 877.667), (1011.667, 876.334), (1017, 870.334), (1014.333, 852.334)],
        [(1053, 975.667), (1058.333, 991.667), (1069, 991.667), (1074.333, 996.334), (1083.667, 994.334),
         (1099, 988.334), (1098.333, 973.667)],
        [(1078.333, 927.667), (1073.667, 931.667), (1074.333, 954.334), (1077, 963.667), (1111, 963.001),
         (1117.667, 944.334), (1117.667, 925.667)],
        [(1109, 966.667), (1103.667, 972.001), (1103.667, 988.667), (1132.333, 994.001), (1144.333, 990.001),
         (1145, 972.001), (1137.667, 965.334)],
        [(1124.333, 947.001), (1123.667, 961.667), (1137.667, 964.334), (1155.667, 961.667), (1159.667, 949.667),
         (1136.333, 945.001)],
        [(1004.333, 888.334), (1005.667, 916.334), (1001, 921.001), (973.667, 919.667), (973.667, 896.334)],
        [(1011.667, 900.334), (1021, 891.667), (1035.667, 891.667), (1045, 910.334), (1040.333, 919.001),
         (1013, 919.001)],
        [(1021, 869.667), (1024.333, 875.667), (1035.667, 876.334), (1038.333, 869.001), (1040.333, 849.001),
         (1021.667, 849.001)],
        [(1047.667, 858.334), (1049, 877.001), (1058.333, 885.001), (1074.333, 885.001), (1073, 857.667)],
        [(1063, 837.001), (1065.667, 842.334), (1060.333, 845.667), (1021, 845.001), (1019.667, 837.001)],
        [(1035.667, 819.667), (1033.667, 835.001), (1013.667, 832.334), (1015.667, 823.001), (1023.667, 818.334)],
        [(1021.667, 808.667), (1023.375, 818.156), (1007.667, 817.001), (1007.667, 807.667)],
        [(1079, 784.334), (1079.667, 801.667), (1075, 808.334), (1054.333, 804.334), (1058.333, 781.001)],
        [(1061, 813.667), (1043, 813.001), (1042.333, 827.667), (1067.667, 829.001), (1067.667, 816.334)],
        [(1090.333, 791.667), (1089, 803.667), (1089, 815.667), (1114.333, 815.667), (1112.333, 796.334)],
        [(1145, 797.001), (1145, 811.667), (1175, 813.001), (1177.667, 805.001), (1167.667, 795.001)],
        [(1193.667, 820.334), (1196.333, 838.334), (1187, 842.334), (1158.333, 839.667), (1170.333, 818.334)],
        [(1197.667, 850.334), (1198.333, 870.334), (1239.667, 871.001), (1243, 850.334)],
        [(1197, 910.334), (1198.333, 935.667), (1225.667, 936.334), (1224.333, 918.334), (1210.333, 910.334)],
        [(1125, 998.334), (1125, 1019.001), (1136.333, 1025.001), (1146.333, 1037.001), (1157, 1037.001),
         (1167.667, 1024.334), (1170.333, 1013.667), (1168.333, 997.001)],
        [(1179, 969.001), (1183.667, 984.334), (1155, 986.334), (1154.333, 969.667)],
        [(1166.333, 966.334), (1196.333, 963.667), (1195.667, 945.667), (1186.333, 934.334), (1183, 917.001),
         (1165, 919.667), (1163, 941.001)],
        [(1084.333, 894.334), (1083, 917.667), (1077, 925.001), (1051.667, 913.001), (1048.333, 897.001),
         (1057, 887.667)],
        [(1085, 853.001), (1077.667, 863.667), (1089, 876.334), (1106.333, 876.334), (1105.667, 853.001)],
        [(1082.333, 848.001), (1074.333, 845.001), (1073.667, 830.334), (1079.667, 825.001), (1140.333, 827.667),
         (1139, 847.667)],
        [(1109.667, 882.334), (1109, 854.334), (1130.333, 854.334), (1131, 882.334)],
        [(1136.667, 885.001), (1149, 901.001), (1159.667, 899.001), (1161.667, 893.001), (1160.333, 850.334),
         (1151.667, 839.667), (1147.667, 839.001), (1146.333, 849.667), (1137, 857.667)],
        [(1224.333, 896.334), (1227.667, 915.001), (1261, 916.334), (1261.667, 901.001), (1252.333, 883.001),
         (1228.333, 889.001)],
        [(1195.333, 867.001), (1195.667, 902.334), (1170.333, 903.001), (1167.667, 877.001), (1181, 877.001),
         (1180.333, 867.001)],
        [(1117.667, 895.667), (1117.667, 920.334), (1085.667, 920.334), (1088.333, 897.001)],
        [(1123.667, 907.001), (1127, 899.001), (1143, 907.001), (1171, 908.334), (1165, 915.001), (1153, 922.334),
         (1151.667, 935.667), (1122.333, 929.667)],
        [(1237, 921.001), (1237.333, 949.667), (1282.333, 951.001), (1311.667, 935.667), (1305.667, 914.334),
         (1282.333, 921.001)],
        [(1280, 896.001), (1279.667, 917.001), (1264, 916.334), (1264.333, 895.001)],
        [(756.333, 991.667), (756.333, 1002.334), (747, 1001.001), (748.333, 990.334)],
        [(503.667, 863.667), (505, 907.001), (496.333, 925.001), (472.333, 925.001), (469.667, 852.334)],
        [(424.333, 811.001), (423.667, 839.001), (375, 842.334), (360.333, 855.001), (354.333, 853.001),
         (354.333, 806.334), (393, 807.001)],
        [(371.667, 856.334), (361, 869.001), (362.333, 897.667), (371, 904.334), (410.333, 897.667), (455.667, 901.667),
         (465, 880.334), (445.667, 859.667), (425.667, 851.001)],
        [(327.667, 829.667), (326.333, 842.334), (277.667, 842.334), (279, 826.334)],
        [(499, 943.001), (497.667, 983.001), (523, 967.001), (524.333, 941.001)],
        [(525.667, 894.334), (530.333, 925.001), (529, 962.334), (543, 976.334), (561.667, 975.001), (561.667, 930.334),
         (567.667, 904.334), (560.333, 903.667), (555.667, 887.667)],
        [(367.667, 907.667), (362.333, 927.667), (376.333, 933.001), (392.333, 927.667), (397, 909.667),
         (390.333, 909.667)],
        [(409, 915.001), (407.667, 940.334), (429.667, 944.334), (441, 937.667), (443, 924.334), (433, 916.334)],
        [(456.333, 930.334), (450.333, 936.334), (455, 946.334), (482.333, 945.667), (489, 933.667),
         (482.333, 931.001)],
        [(497, 990.334), (495.667, 1007.667), (497, 1015.667), (512.333, 1015.001), (514.333, 992.334)],
        [(520.333, 987.667), (519.667, 1012.334), (535, 1012.334), (538.333, 1007.667), (538.333, 992.334),
         (531, 985.667)],
        [(490.333, 1050.334), (487.667, 1075.001), (463.667, 1075.001), (463, 1053.667)],
        [(275.667, 938.334), (277, 942.334), (278.333, 962.334), (268.333, 962.334), (261, 957.001), (247.667, 957.001),
         (247.667, 937.001)],
        [(359.667, 1043.001), (406.333, 1044.334), (410.333, 1085.001), (364.333, 1089.001), (357.667, 1085.001)],
        [(349.667, 1037.667), (315.667, 1037.001), (311, 989.001), (343, 989.001), (350.333, 1002.334)],
        [(352.333, 1051.001), (349.667, 1107.667), (302.333, 1109.001), (299, 1097.001), (311, 1091.001),
         (311, 1081.667), (305, 1073.001), (307.667, 1056.334), (305.667, 1042.334), (341, 1044.334)],
        [(301, 997.001), (303.667, 1035.001), (257.667, 1038.334), (254.333, 1032.334), (255.667, 1013.001),
         (267, 1011.667), (269, 997.001)],
        [(297.667, 915.001), (298.333, 935.001), (332.333, 939.001), (337.667, 929.667), (353.667, 925.667),
         (349, 918.334)],
        [(307.667, 866.667), (333, 863.001), (351.667, 883.667), (341, 898.334), (335.667, 912.334), (241.667, 909.001),
         (243.667, 862.334)],
        [(231.667, 848.334), (236.333, 891.001), (239, 906.334), (229, 911.667), (209, 910.334), (183.667, 892.334),
         (185, 855.667), (218.333, 845.667)],
        [(177.667, 923.667), (193, 917.001), (209, 910.334), (232.333, 914.334), (240.333, 925.001), (242.333, 951.667),
         (234.333, 959.667), (226.333, 959.667), (219.667, 955.667), (207, 957.001), (194.333, 963.001),
         (176.333, 955.001)],
        [(189, 964.334), (190.333, 1022.334), (167, 1021.001), (166.333, 1017.001), (154.333, 1017.001),
         (154.333, 1009.001), (145, 1006.334), (139.667, 1001.667), (141, 969.667), (152.333, 964.334)],
        [(116.5, 937), (135.5, 939), (136.5, 1016), (147, 1017), (148.5, 1023.5), (140.5, 1026.5), (132, 1027),
         (123, 1011.5), (120.5, 988), (114.5, 979)],
        [(86, 1006.5), (104.5, 1008), (106, 1017), (109, 1020.5), (108.5, 1033), (103, 1045), (86.5, 1043.5)],
        [(107, 1073), (125, 1069.5), (131, 1075), (129.5, 1116.5), (114, 1120.5), (109, 1113)],
        [(101, 1133), (105, 1160), (129.5, 1163.5), (128.5, 1139.5), (120, 1139), (111.5, 1130)],
        [(179, 1171), (176.5, 1186), (205, 1185), (208, 1182.5), (207.5, 1172), (204.5, 1159.5)],
        [(175, 1179.5), (175, 1188), (179, 1209.5), (175, 1234), (133, 1234.5), (118, 1225.5), (117, 1199),
         (122.5, 1188), (122.5, 1178.5)],
        [(222, 1147), (221, 1164), (233.5, 1168), (238, 1166), (238, 1146)],
        [(243, 1130), (270, 1126.5), (275, 1144.5), (270.5, 1150), (263, 1151), (256.5, 1155.5), (245.5, 1152.5)],
        [(259, 1097.5), (260, 1115.5), (265.5, 1121.5), (270.5, 1114), (278, 1120), (282.5, 1096)],
        [(283.5, 1125.5), (283, 1144), (293, 1154), (351, 1154), (352.5, 1124.5)],
        [(363.5, 1125), (365, 1165), (381, 1170.5), (415.5, 1169), (415, 1124.5)],
        [(423, 1129), (425, 1173), (431, 1179.5), (464, 1175), (471, 1162.5), (469.5, 1125.5)],
        [(361.5, 1093.5), (358, 1101.5), (358.5, 1109.5), (432, 1108.5), (432, 1093.5)],
        [(417.5, 1044.5), (408, 1036.5), (408.5, 1009), (476.5, 1002), (488, 1003), (486, 1024.5), (475.5, 1040),
         (450, 1040.5)],
        [(416, 1048), (449, 1042.5), (449, 1071), (445, 1081.5), (426, 1082.5), (416, 1071)],
        [(355.5, 1041.5), (388.5, 1040), (395, 1036), (389.5, 1002), (372, 991), (353.5, 995)],
        [(407, 955), (405.5, 984), (444.5, 985), (445, 954.5)],
        [(448.5, 954.5), (449.5, 984), (456.5, 988.5), (482.5, 987.5), (482, 970), (488, 965.5), (487, 952.5)],
        [(357.5, 942.5), (357.5, 975), (362.5, 985.5), (376, 983.5), (399, 986), (399.5, 955.5), (393, 937.5)],
        [(314, 950.5), (315.5, 975), (306.5, 985), (291.5, 985.5), (282.5, 977.5), (284, 961), (293.5, 949.5)],
        [(272, 972), (274.5, 992), (254, 993), (247.5, 985.5), (254.5, 967.5)],
        [(245.5, 1024.5), (244.5, 1048), (216, 1058), (200, 1051.5), (201, 1033), (205.5, 1022.5)],
        [(248, 1014), (207, 1013.5), (209, 981.5), (221.5, 982.5), (226, 975), (235.5, 973.5), (250, 992.5)],
        [(181.5, 1035.5), (179.5, 1081.5), (170.5, 1086.5), (143.5, 1066), (128.5, 1063), (128.5, 1034.5), (150, 1030),
         (175.5, 1028.5)],
        [(184.5, 1062.5), (195.5, 1076), (237.5, 1071), (247.5, 1067), (240, 1057), (214.5, 1062.5)],
        [(197, 1081), (193.5, 1128), (202, 1137), (212, 1137.5), (220.5, 1132.5), (237, 1111), (237, 1097.5),
         (225, 1081.5)],
        [(259.5, 1045), (271, 1063.5), (292.5, 1063.5), (296.5, 1063.5), (295, 1047.5)],
        [(262, 1065.5), (264.5, 1078.5), (268.5, 1081.5), (268.5, 1088.5), (290.5, 1089), (295.5, 1083), (296, 1068.5)],
        [(182.5, 1097), (184, 1151.5), (178.5, 1162), (156.5, 1162), (143.5, 1152.5), (140, 1129.5), (139.5, 1102.5),
         (171.5, 1100)],
        [(240, 1166), (243, 1188), (252, 1193), (259.5, 1193.5), (276.5, 1203.5), (288.5, 1202), (294, 1197),
         (292.5, 1176), (285.5, 1174), (278, 1163.5)],
        [(234.5, 1189), (243, 1191), (248, 1197), (245.5, 1201.5), (200, 1203), (192.5, 1195.5), (206.5, 1192),
         (212.5, 1187)],
        [(242.5, 1208), (236.5, 1217.5), (237.5, 1239.5), (247, 1238.5), (252, 1252.5), (274, 1259), (283, 1246),
         (292.5, 1240), (291.5, 1216.5), (283.5, 1208), (275.5, 1206), (269.5, 1204)],
        [(200.5, 1230.5), (205, 1245.5), (230.5, 1246), (233, 1239), (230.5, 1224)],
        [(195, 1275.5), (195.5, 1285), (164.5, 1284), (164, 1273.5)],
        [(219, 1267.5), (219.5, 1279.5), (251.5, 1279), (251, 1269.5)],
        [(217.5, 1291), (214.5, 1301.5), (199, 1300), (200, 1288.5)],
        [(300, 1210), (312.5, 1225.5), (324.5, 1228.5), (348, 1248.5), (345.5, 1199.5), (321.5, 1197)],
        [(314.5, 984.5), (341.5, 984), (344.5, 976.5), (354, 976.5), (353, 948.5), (332, 942), (322.5, 957),
         (318.5, 973)],
        [(456.5, 1087), (456.5, 1116.5), (474.5, 1118.5), (481.5, 1114.5), (488, 1085)],
        [(499, 1094.5), (500.5, 1111.5), (525.5, 1113.5), (526, 1097.5), (522.5, 1093)],
        [(500.5, 1033.5), (509, 1020.5), (541.5, 1029), (542.5, 1041), (545, 1044.5), (545, 1069.5), (529.5, 1081),
         (498.5, 1081.5)],
        [(349.5, 1170.5), (351, 1192.5), (346.5, 1196.5), (320.5, 1194), (312.5, 1193.5), (312.5, 1177), (317, 1169)],
        [(484.5, 1124), (485, 1140.5), (490, 1143), (502.5, 1141.5), (515.5, 1133), (515, 1122.5)],
        [(520.5, 1127.5), (522, 1153), (540, 1153), (540, 1131.5), (525.5, 1131.5)],
        [(511.5, 1161.5), (513, 1178), (517, 1181), (518, 1184.5), (530.5, 1181), (538.5, 1182.5), (538.5, 1160)],
        [(508.5, 1156), (506.5, 1182.5), (489.5, 1181), (478.5, 1177), (478, 1156.5)],
        [(516, 1197.5), (519.5, 1194), (535, 1193.5), (537.5, 1211.5), (518, 1212)],
        [(244, 1292), (244, 1295.5), (262, 1297), (262.5, 1293.5), (256, 1292.5), (255.5, 1289), (248, 1288.5)],
        [(264, 1272), (263.5, 1284.5), (272, 1287), (272.5, 1273)],
        [(258, 1311), (259, 1320), (287, 1322.5), (285.5, 1307.5), (281.5, 1311)],
        [(263, 1336.5), (261.5, 1341), (272.5, 1346.5), (276.5, 1351), (282.5, 1341.5), (283, 1335.5)],
        [(296.5, 1332), (293.5, 1352), (314.5, 1355.5), (326.5, 1344.5), (329.5, 1336), (324.5, 1328.5),
         (310.5, 1333.5)],
        [(296.5, 1322.5), (314, 1322.5), (318.5, 1318.5), (318, 1290.5), (282.5, 1293.5), (285, 1301.5), (298.5, 1301)],
        [(240, 1314.5), (240, 1321), (229.5, 1321.5), (230, 1312.5)],
        [(293, 1265.5), (327, 1266.5), (328.5, 1253), (297.5, 1250)],
        [(338.5, 1288.5), (336, 1313.5), (344, 1318), (351, 1316.5), (354.5, 1300), (359.5, 1295), (359, 1286.5)],
        [(458.333, 1217.333), (472.667, 1214), (481.667, 1209.333), (484, 1194.667), (463.333, 1192),
         (459.333, 1195.333)],
        [(488, 1215.333), (514, 1213.333), (514, 1205), (509.333, 1192.333), (500, 1191), (487.333, 1189)],
        [(487, 1221.667), (488.667, 1238), (469, 1239.333), (459.333, 1228.667), (457.667, 1223)],
        [(470.333, 1245.333), (468.333, 1258), (472, 1261.667), (481.333, 1260.667), (487.667, 1255.333),
         (485, 1251.333), (484.333, 1248), (477, 1244.333)],
        [(441.667, 1243), (448.667, 1260), (436.333, 1258.333), (432.667, 1253.667), (432.667, 1246),
         (437.333, 1242.667)],
        [(465.333, 1288.333), (464, 1303.667), (448, 1302.667), (448.333, 1288)],
        [(435.667, 1315.333), (453.667, 1331.667), (469.333, 1332.333), (477, 1325), (469, 1314), (450.333, 1314.333)],
        [(453.667, 1333.667), (452.667, 1338), (442, 1342.333), (443.333, 1348.333), (454.667, 1354.333),
         (464, 1347.333), (476.333, 1347), (478.333, 1342), (478.667, 1336.667), (467.667, 1336)],
        [(439.333, 1329.333), (437.333, 1343), (427.667, 1342.667), (422.333, 1333), (429.667, 1328.333)],
        [(414.333, 1313), (414.333, 1324.333), (401.667, 1325.333), (392.333, 1322.333), (392, 1312.333)],
        [(403.333, 1327.667), (389.333, 1332.667), (391, 1338), (400.667, 1339.667), (414.667, 1341.333),
         (415.667, 1335), (412, 1329)],
        [(384.333, 1344.667), (384, 1355.667), (361.333, 1359.333), (359.667, 1350.667), (367, 1345), (376, 1343.667)],
        [(483.333, 1294.333), (478.667, 1298.667), (478.333, 1305), (493.333, 1305.667), (495.333, 1297)],
        [(504.667, 1290), (506.333, 1303.333), (542, 1304.667), (543.333, 1292.333), (522.667, 1290.333)],
        [(536.333, 1282.333), (561.333, 1282.333), (560, 1273), (558.667, 1250.667), (544.333, 1248.667),
         (534, 1255.333), (537.333, 1267), (533.667, 1272)],
        [(558, 1241), (549.667, 1242.667), (542, 1238), (513, 1238), (512, 1225.333), (521.333, 1223.333),
         (520.667, 1217), (557.333, 1214.667)],
        [(514.667, 1241.333), (502.667, 1241.667), (500, 1248.333), (503.333, 1255.667), (519, 1261), (526, 1253.333),
         (524.667, 1241)],
        [(453.333, 1265.333), (489, 1264.333), (488.333, 1272), (482.333, 1280.333), (468, 1280.333)],
        [(496.667, 1267.667), (528, 1266.333), (527.333, 1279), (520.333, 1284.667), (505.333, 1284.667),
         (498.333, 1277)],
        [(455.333, 1208.333), (456.667, 1239), (430.333, 1239.333), (430.333, 1210.333), (444, 1210.333)],
        [(424, 1200.667), (423, 1234), (410, 1241.667), (392.667, 1243.333), (381, 1250.667), (378.333, 1266),
         (355.667, 1266.333), (355.667, 1239.333), (355.667, 1202.333), (372, 1199.333), (369.333, 1178.667),
         (403.843, 1177.342), (406.667, 1199.333)],
        [(480.333, 1316), (481, 1323.333), (500, 1326), (508.667, 1326), (520, 1321.333), (519.333, 1311.667),
         (482, 1310.667)],
        [(433, 1290.333), (431.333, 1305.333), (387.333, 1305.667), (376.333, 1298.333), (375.667, 1291.333),
         (397, 1292), (416.333, 1291.667), (421.667, 1287), (430, 1287)],
        [(385, 1311.667), (385, 1329.333), (364, 1330.333), (356.333, 1312.667), (367.333, 1310), (379.333, 1309)],
        [(353.333, 1332.333), (352, 1345.333), (332, 1345.333), (332, 1332.667)],
    ]




# Custom shape generators for benchmarks
radius_scale = 1

class SG1(LShapeGenerator):
    def __init__(self, container=None):
        super().__init__(radius=10 * radius_scale, rotations=Symmetry.fourfold, size=floor(640 / sqrt(86609) * 1e6) / 1e6, container=container)

class SG2(SquareShapeGenerator):
    def __init__(self, container=None):
        super().__init__(radius=10 * radius_scale, rotations=Symmetry.none, size=floor(20 / sqrt(53) * 1e6) / 1e6, container=container)

class SG3(CuttedShapeGenerator):
    def __init__(self, container=None):
        super().__init__(radius=10 * radius_scale, rotations=Symmetry.twofold, container=container)

class SG4(RealShapeGenerator):
    def __init__(self, container=None):
        super().__init__(radius=10 * radius_scale, rotations=Symmetry.threefold, scale=0.02, container=container)

class SG5(RandomShapeGenerator):
    def __init__(self, container=None):
        super().__init__(radius=10 * radius_scale, rotations=Symmetry.sixfold, fixed_seed=1701, container=container)

class SG6(CecoinGenerator):
    def __init__(self, container=None):
        super().__init__(radius=10 * radius_scale, rotations=Symmetry.fourfold, scale=0.052219322 / 3 * 2, container=container)

class SG7(RandomHexagonShapeGenerator):
    def __init__(self, container=None):
        super().__init__(radius=10 * radius_scale, rotations=Symmetry.fourfold, fixed_seed=1701, container=container)


# generator for parsing datasets
def norm_data(poly, num):
    for ver in poly:
        ver[0] = ver[0] * num
        ver[1] = ver[1] * num


def parse_from_seanys_csv(filename: str, scale):
    dataset = pd.read_csv(filename + ".csv")
    polygons = []
    for i in range(0, dataset.shape[0]):
        for j in range(0, dataset['num'][i]):
            poly = json.loads(dataset['polygon'][i])
            norm_data(poly, scale)
            polygons.append(poly)
    return polygons


class FromCSVFileShapeGenerator(ShapeGenerator):
    def _get_shape(self):
        if len(self._shape_buffer) == 0:
            # return some extra big shape that is impossible to place
            big_number = self._radius * self._radius * 100
            a = [[0, 0], [big_number, 0], [big_number, big_number], [0, big_number]]
            return a
        s = self._shape_buffer.pop(0)
        return s

    def __init__(self, polygon_radius: float, rotations: Symmetry, filename: str, container, scale):
        self._shape_buffer = parse_from_seanys_csv(filename, scale)
        for i in range(len(self._shape_buffer)):
            #print(self._shape_buffer[i])
            pol = Polygon(self._shape_buffer[i])
            #print('polygon area:', pol.area)
        super().__init__(radius=polygon_radius, rotations=rotations, container=container)
